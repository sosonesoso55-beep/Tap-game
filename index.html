<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anime Tap</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:sans-serif}
body{
  background: radial-gradient(circle at top,#1b0033,#000);
  color:white;
  height:100vh;
  overflow:hidden;
}

#score{
  text-align:center;
  font-size:28px;
  margin-top:15px;
}

#girl{
  display:block;
  margin:40px auto;
  width:260px;
  transition:transform 0.1s, filter 0.1s;
  filter:drop-shadow(0 0 30px #ff66ff);
}

#girl:active{
  transform:scale(0.92);
  filter:drop-shadow(0 0 60px #ff99ff);
}

#musicBtn{
  position:fixed;
  top:15px;
  right:15px;
  padding:10px 14px;
  background:#ff4dff;
  border:none;
  border-radius:12px;
  color:white;
  font-size:16px;
}
</style>
</head>

<body>

<button id="musicBtn">üîä</button>
<div id="score">0 ‚≠ê</div>

<img id="girl" src="girl.png">

<!-- –ó–í–£–ö–ò -->
<audio id="bgm" src="music.mp3" loop></audio>
<audio id="tapSound" src="tap.mp3"></audio>

<script>
const SERVER = "https://anime-tap-server-1.onrender.com";
const USER_ID = "user_" + Math.random().toString(36).slice(2);

const scoreEl = document.getElementById("score");
const girl = document.getElementById("girl");
const bgm = document.getElementById("bgm");
const tapSound = document.getElementById("tapSound");
const musicBtn = document.getElementById("musicBtn");

let musicOn = false;

/* ===== –ú–£–ó–´–ö–ê ===== */
musicBtn.onclick = ()=>{
  if(!musicOn){
    bgm.volume = 0.5;
    bgm.play();
    musicBtn.innerText="üîà";
  }else{
    bgm.pause();
    musicBtn.innerText="üîä";
  }
  musicOn=!musicOn;
};

/* ===== –ó–ê–ì–†–£–ó–ö–ê ===== */
async function load(){
  const r = await fetch(`${SERVER}/me?id=${USER_ID}`);
  const d = await r.json();
  scoreEl.innerText = d.score + " ‚≠ê";
}
load();

/* ===== –¢–ê–ü ===== */
async function tap(){
  tapSound.currentTime = 0;
  tapSound.volume = 0.8;
  tapSound.play();

  const r = await fetch(`${SERVER}/tap`,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({id:USER_ID})
  });
  const d = await r.json();
  scoreEl.innerText = d.score + " ‚≠ê";
}

girl.onclick = tap;
</script>

</body>
</html>
